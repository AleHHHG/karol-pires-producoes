<%= form_with(model: order) do |form| %>
  <% if order.errors.any? %>
    <div class="alert alert-danger">
      <h4>O pedido não pode ser salvo:</h4>

      <ul>
        <% order.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="row">
    <div class="col">
      <%= form.label :owner, 'Solicitante', class: 'form-label' %>
      <%= select :order, :owner_id, Owner.all.collect { |p| [ p.name, p.id ] }, { prompt: 'Selecione o solicitante' }, { class: 'form-select' }  %>
    </div>
    <div class="col">
      <%= form.label :project, 'Projeto', class: 'form-label' %>
      <%= select :order, :project_id, Project.all.collect { |p| [ p.name, p.id ] }, { prompt: 'Selecione o projeto' }, { class: 'form-select' }  %>
    </div>
    <div class="col">
      <%= form.label :supplier, 'Fornecedor', class: 'form-label' %>
      <%= select :order, :supplier_id, Supplier.all.collect { |p| [ p.name, p.id ] }, { prompt: 'Selecione o fornecedor' }, { class: 'form-select' }  %>
    </div>
    <div class="col">
      <%= form.label :approver, 'Aprovador', class: 'form-label' %>
      <%= select :order, :approver_id, Approver.all.collect { |p| [ p.name, p.id ] }, { prompt: 'Selecione o Aprovador' }, { class: 'form-select' }  %>
    </div>
  </div>
  <br clear="all">

  <div class="row">
    <div class="col">
      <%= form.label :price, 'Valor', class: 'form-label' %>
      <%= form.text_field :price, class: 'form-control' %>
    </div>
    <div class="col">
      <%= form.label :due_date, 'Vencimento', class: 'form-label' %>
      <%= form.date_field :due_date, class: 'form-control'  %>
    </div>
  </div>
  <br clear="all">

  <div class="row">
    <div class="col">
      <%= form.label :goal, 'Finalidade', class: 'form-label' %>
      <%= form.text_area :goal, size: "90x8", class: 'form-control'  %>
    </div>
    <div class="col">
      <%= form.label :note, 'Observação', class: 'form-label' %>
      <%= form.text_area :note, size: "90x8", class: 'form-control'  %>
    </div>
  </div>
  <br clear="all">

  <% if order.new_record? %>
    <%= form.hidden_field :status, value: 'requested' %>
  <% else %>
    <%= form.label :status, 'Status', class: 'form-label' %>
    <%= select :order, :status, [['Solicitado', 'requested'], ['Em andamento', 'in_progress'], ['Concluído', 'done']], {}, class: 'form-select' %>
  <% end %>

  <br clear="all">


  <h5 class="card-title mt-2 mb-4">Colaboradores</h5>

  <div class="row">
    <%= form.collection_check_boxes :person_ids, Person.order(:name), :id, :name, { class: } do |b| %>
      <div class="col">
        <div class="form-check">
          <%=  b.check_box(class: 'form-check-input') %>
          <%=  b.label(class: 'form-check-label')  %>
        </div>
      </div>
    <% end %>
  </div>
  <%= form.submit 'Salvar', class: 'btn btn-primary mt-3 btn-lg float-end' %>
<% end %>
<br clear="all"/>